<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
        <meta name="sogou_site_verification" content="true">
    
    
    
    <title>
        fastdfs安装配置及fast-nginx-module整合nginx |
        
        Li &#39; s Blog
         | 写字的地方
        
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="fastdfs,nginx">
    <meta name="description" content="由于最近做项目需要用到文件系统，选择了fastdfs+nginx 但是在安装过程中出现了各种报错，在此把踩过的坑都记录一下，下面我介绍的方法，是我亲自验证过的，只要安装的版本和我的一致应该是没问题的。安装过程出现报错大部分都是版本问题，请更换版本安装,尽量选择新版本 1.下载所需的软件以及工具包fastdfs作者的github:https:&#x2F;&#x2F;github.com&#x2F;happyfish100 所需的">
<meta property="og:type" content="article">
<meta property="og:title" content="fastdfs安装配置及fast-nginx-module整合nginx">
<meta property="og:url" content="https://banatech.org/20220508/fastDfsConfig.html">
<meta property="og:site_name" content="Li &#39; s Blog">
<meta property="og:description" content="由于最近做项目需要用到文件系统，选择了fastdfs+nginx 但是在安装过程中出现了各种报错，在此把踩过的坑都记录一下，下面我介绍的方法，是我亲自验证过的，只要安装的版本和我的一致应该是没问题的。安装过程出现报错大部分都是版本问题，请更换版本安装,尽量选择新版本 1.下载所需的软件以及工具包fastdfs作者的github:https:&#x2F;&#x2F;github.com&#x2F;happyfish100 所需的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209083103614.png?msec=1652018063704">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209101441171.png?msec=1652018063679">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209083332152.png?msec=1652018063703">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209083453661.png?msec=1652018063774">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209103208043.png?msec=1652018063662">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209090103427.png?msec=1652018063677">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209091431415.png?msec=1652018063663">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209092144873.png?msec=1652018063701">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209092852821.png?msec=1652018063705">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209093245661.png?msec=1652018063710">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209093522679.png?msec=1652018063708">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209103008068.png?msec=1652018063682">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209103101268.png?msec=1652018063877">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209105544164.png?msec=1652018063685">
<meta property="og:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209105840511.png?msec=1652018063663">
<meta property="article:published_time" content="2022-05-08T13:53:19.000Z">
<meta property="article:modified_time" content="2022-05-08T14:07:32.868Z">
<meta property="article:author" content="李子灿">
<meta property="article:tag" content="fastdfs">
<meta property="article:tag" content="nginx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://banatech.org/20220508/fastDfsConfig/image-20211209083103614.png?msec=1652018063704">
    
        <link rel="alternate" type="application/atom+xml" title="Li &#39; s Blog"
              href="/atom.xml">
    
<!--    <link rel="shortcut icon" href="/favicon.ico">-->
    <link rel="shortcut icon" type="image/ico" href="//favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts = []</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 6.1.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">李子灿</h5>
          <a href="mailto:lizican123@gmail.com" title="lizican123@gmail.com" class="mail">lizican123@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/git-xiaocan" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">fastdfs安装配置及fast-nginx-module整合nginx</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">fastdfs安装配置及fast-nginx-module整合nginx</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-05-08T13:53:19.000Z" itemprop="datePublished" class="page-time">
  2022-05-08
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-%E4%B8%8B%E8%BD%BD%E6%89%80%E9%9C%80%E7%9A%84%E8%BD%AF%E4%BB%B6%E4%BB%A5%E5%8F%8A%E5%B7%A5%E5%85%B7%E5%8C%85"><span class="post-toc-number">1.</span> <span class="post-toc-text">1.下载所需的软件以及工具包</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%A6%96%E5%85%88%E5%AE%89%E8%A3%85libfastcommon"><span class="post-toc-number">2.</span> <span class="post-toc-text">首先安装libfastcommon</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AE%89%E8%A3%85fastdfs"><span class="post-toc-number">3.</span> <span class="post-toc-text">安装fastdfs</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AEtracker%E6%9C%8D%E5%8A%A1"><span class="post-toc-number">3.0.1.</span> <span class="post-toc-text">配置tracker服务</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%90%AF%E5%8A%A8-tracker-%E6%9C%8D%E5%8A%A1"><span class="post-toc-number">3.0.2.</span> <span class="post-toc-text">启动 tracker 服务</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AEstorage"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">配置storage</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%90%AF%E5%8A%A8storage-%E6%9C%8D%E5%8A%A1"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">启动storage 服务</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%B5%8B%E8%AF%95%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">测试上传文件</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AENginx-%E6%95%B4%E5%90%88fastdfs-nginx-module%E8%AE%BF%E9%97%AE"><span class="post-toc-number">4.</span> <span class="post-toc-text">配置Nginx 整合fastdfs-nginx-module访问</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AEnginx-%E4%BB%A3%E7%90%86"><span class="post-toc-number">4.0.1.</span> <span class="post-toc-text">配置nginx 代理</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


    <article id="post-fastDfsConfig" class="post-article article-type-post fade"
        itemprop="blogPost">

        <div class="post-card">
            <h1 class="post-card-title">
                fastdfs安装配置及fast-nginx-module整合nginx
            </h1>
            <div class="post-meta">
                <time class="post-time" title="2022-05-08 21:53:19" datetime="2022-05-08T13:53:19.000Z"  itemprop="datePublished">2022-05-08</time>

                    


                        
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            </div>
            <div class="post-content" id="post-content" itemprop="postContent">
                <p>由于最近做项目需要用到文件系统，选择了fastdfs+nginx 但是在安装过程中出现了各种报错，在此把踩过的坑都记录一下，下面我介绍的方法，是我亲自验证过的，只要安装的版本和我的一致应该是没问题的。安装过程出现报错大部分都是版本问题，请更换版本安装,尽量选择新版本</p>
<h2 id="1-下载所需的软件以及工具包"><a href="#1-下载所需的软件以及工具包" class="headerlink" title="1.下载所需的软件以及工具包"></a>1.下载所需的软件以及工具包</h2><p>fastdfs作者的github:<a target="_blank" rel="noopener" href="https://github.com/happyfish100">https://github.com/happyfish100</a> 所需的所有软件包都可以在这里下载</p>
<p>我安装的对应的版本: fastdfs-6.07 fastdfs-nginx-module-1.22 nginx-1.10.1</p>
<p>下载对应软件包 下面是所需软件的下载地址</p>
<p>fastdfs v6.07</p>
<p><a target="_blank" rel="noopener" href="https://github.com/happyfish100/fastdfs/releases/tag/V6.07">https://github.com/happyfish100/fastdfs/releases/tag/V6.07</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209083103614.png?msec=1652018063704" alt="image20211209083103614" title>
                </div>
                <div class="image-caption">image20211209083103614</div>
            </figure>

<p>Fastdfs-nginx-module v1.22</p>
<p><a target="_blank" rel="noopener" href="https://github.com/happyfish100/fastdfs-nginx-module/releases/tag/V1.22">https://github.com/happyfish100/fastdfs-nginx-module/releases/tag/V1.22</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209101441171.png?msec=1652018063679" alt="image20211209101441171" title>
                </div>
                <div class="image-caption">image20211209101441171</div>
            </figure>

<p>libfastcommon v1.0.53</p>
<p><a target="_blank" rel="noopener" href="https://github.com/happyfish100/libfastcommon/releases/tag/V1.0.53">https://github.com/happyfish100/libfastcommon/releases/tag/V1.0.53</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209083332152.png?msec=1652018063703" alt="image20211209083332152" title>
                </div>
                <div class="image-caption">image20211209083332152</div>
            </figure>

<p>nginx 1.10.1</p>
<p><a target="_blank" rel="noopener" href="http://nginx.org/download/nginx-1.10.1.tar.gz">http://nginx.org/download/nginx-1.10.1.tar.gz</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209083453661.png?msec=1652018063774" alt="image20211209083453661" title>
                </div>
                <div class="image-caption">image20211209083453661</div>
            </figure>

<p>下面开始安装</p>
<p>在<code>/usr/local/src</code> 目录下信件fastdfs 文件夹 用于存放安装所需的所有软件包源码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-16-12-centos ~]# mkdir /usr/local/src/fastdfs</span><br><span class="line">[root@VM-16-12-centos ~]# cd /usr/local/src/fastdfs/</span><br><span class="line">[root@VM-16-12-centos fastdfs]#</span><br></pre></td></tr></table></figure>

<p>首先安装基础环境</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install zlib zlib-devel pcre pcre-devel gcc gcc-c++ openssl openssl-devel libevent libevent-devel perl unzip net-tools wget</span><br></pre></td></tr></table></figure>

<p>下载fastdfs安装所需软件包 下面是所有软件包 请自行前往上面提供的链接下载</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209103208043.png?msec=1652018063662" alt="image20211209103208043" title>
                </div>
                <div class="image-caption">image20211209103208043</div>
            </figure>

<p>下面开始安装</p>
<h2 id="首先安装libfastcommon"><a href="#首先安装libfastcommon" class="headerlink" title="首先安装libfastcommon"></a>首先安装libfastcommon</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf libfastcommon-1.0.53.tar.gz #解压软件包</span><br><span class="line">cd libfastcommon-1.0.53/ # 进入目录</span><br><span class="line">./make.sh  #编译</span><br><span class="line">./make.sh install # 安装</span><br></pre></td></tr></table></figure>

<p>验证是否安装成功</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209090103427.png?msec=1652018063677" alt="image20211209090103427" title>
                </div>
                <div class="image-caption">image20211209090103427</div>
            </figure>

<p>添加软连接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so</span><br><span class="line">ln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.so</span><br><span class="line">ln -s /usr/lib64/libfdfsclient.so /usr/local/lib/libfdfsclient.so</span><br><span class="line">ln -s /usr/lib64/libfdfsclient.so /usr/lib/libfdfsclient.so</span><br></pre></td></tr></table></figure>

<h2 id="安装fastdfs"><a href="#安装fastdfs" class="headerlink" title="安装fastdfs"></a>安装fastdfs</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf fastdfs-6.07.tar.gz #解压</span><br><span class="line">cd fastdfs-6.07/ #进入解压目录</span><br><span class="line">./make.sh #编译</span><br><span class="line">./make.sh install #安装</span><br></pre></td></tr></table></figure>

<p>fastdfs 默认安装在 <code>/etc/fdfs</code> 目录下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/fdfs/ ##进入安装目录</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将下列三个配置文件全部<span class="built_in">cp</span> 一份</span></span><br><span class="line">cp storage.conf.sample  storage.conf</span><br><span class="line">cp tracker.conf.sample tracker.conf</span><br><span class="line">cp client.conf.sample  client.conf</span><br></pre></td></tr></table></figure>

<h4 id="配置tracker服务"><a href="#配置tracker服务" class="headerlink" title="配置tracker服务"></a>配置tracker服务</h4><p>新建fastdfs 数据的存放目录 下面是我存放的位置</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209091431415.png?msec=1652018063663" alt="image20211209091431415" title>
                </div>
                <div class="image-caption">image20211209091431415</div>
            </figure>

<p>修改tracker的配置文件 需要修改下面几个配置项</p>
<p>base_path &#x3D; &#x2F;home&#x2F;yuqing&#x2F;fastdfs 修改为 base_path &#x3D; &#x2F;usr&#x2F;fdfs_data （对应你自己的目录）</p>
<p>http.server_port &#x3D; 8080 修改为 http.server_port &#x3D; 8888 (http服务对应的端口)</p>
<h4 id="启动-tracker-服务"><a href="#启动-tracker-服务" class="headerlink" title="启动 tracker 服务"></a>启动 tracker 服务</h4><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209092144873.png?msec=1652018063701" alt="image20211209092144873" title>
                </div>
                <div class="image-caption">image20211209092144873</div>
            </figure>

<h3 id="配置storage"><a href="#配置storage" class="headerlink" title="配置storage"></a>配置storage</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/fdfs/storage.conf</span><br></pre></td></tr></table></figure>

<p>修改下面配置项</p>
<p>base_path &#x3D; &#x2F;home&#x2F;yuqing&#x2F; 修改为 base_path &#x3D; &#x2F;usr&#x2F;fdfs_data</p>
<p>store_path0 &#x3D; &#x2F;usr&#x2F;fdfs_data&#x2F;storage 修改为 store_path0 &#x3D; &#x2F;usr&#x2F;fdfs_data&#x2F;storage</p>
<p>tracker_server &#x3D; 192.168.1.2:22122 修改为 tracker_server &#x3D; 服务器ip:22122</p>
<p>http.server_port &#x3D; 8080 修改为http.server_port &#x3D; 8888</p>
<h4 id="启动storage-服务"><a href="#启动storage-服务" class="headerlink" title="启动storage 服务"></a>启动storage 服务</h4><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209092852821.png?msec=1652018063705" alt="image20211209092852821" title>
                </div>
                <div class="image-caption">image20211209092852821</div>
            </figure>

<p>下面配置 client 服务 测试上传功能</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/fdfs/client.conf</span><br></pre></td></tr></table></figure>

<p>修改下面配置项</p>
<p>base_path &#x3D; &#x2F;usr&#x2F;fdfs_data</p>
<p>tracker_server &#x3D; 192.168.0.196:22122 修改为 tracker_server &#x3D; 服务器ip:22122</p>
<p>http_tracker_server_port &#x3D;80 修改为http_tracker_server_port &#x3D; 8888</p>
<h4 id="测试上传文件"><a href="#测试上传文件" class="headerlink" title="测试上传文件"></a>测试上传文件</h4><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209093245661.png?msec=1652018063710" alt="image20211209093245661" title>
                </div>
                <div class="image-caption">image20211209093245661</div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209093522679.png?msec=1652018063708" alt="image20211209093522679" title>
                </div>
                <div class="image-caption">image20211209093522679</div>
            </figure>

<p>将fastdfs源码conf目录下的两个配置文件复制到&#x2F;etc&#x2F;fdfs目录下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/src/fastdfs/fastdfs-6.07/conf/http.conf  /etc/fdfs/</span><br><span class="line"> cp /usr/local/src/fastdfs/fastdfs-6.07/conf/mime.types  /etc/fdfs/</span><br></pre></td></tr></table></figure>

<h2 id="配置Nginx-整合fastdfs-nginx-module访问"><a href="#配置Nginx-整合fastdfs-nginx-module访问" class="headerlink" title="配置Nginx 整合fastdfs-nginx-module访问"></a>配置Nginx 整合fastdfs-nginx-module访问</h2><p>配置 fastdfs-nginx-module</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf fastdfs-nginx-module-1.20.tar.gz ##解压</span><br><span class="line">tar -zxvf nginx-1.10.1.tar.gz</span><br><span class="line">cd ./nginx-1.10.1</span><br><span class="line">./configure --prefix=/usr/local/nginx  --add-module=/usr/local/src/fastdfs/fastdfs-nginx-module-1.22/src</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>修改 fastdfs-nginx-module-1.22&#x2F;src&#x2F;mod_fastdfs.conf 配置文件 并复制到 &#x2F;etc&#x2F;fdfs 目录</p>
<p>修改下列几项</p>
<p>base_path&#x3D;&#x2F;usr&#x2F;fdfs_data</p>
<p>tracker_server&#x3D;服务器ip:22122 对应tracker服务的ip</p>
<p>store_path0&#x3D;&#x2F;usr&#x2F;fdfs_data&#x2F;storage</p>
<p>url_have_group_name &#x3D; true</p>
<h4 id="配置nginx-代理"><a href="#配置nginx-代理" class="headerlink" title="配置nginx 代理"></a>配置nginx 代理</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/nginx/conf/nginx/conf</span><br></pre></td></tr></table></figure>

<p>nginx.conf</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       8888;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">        location /group1/M00&#123;</span><br><span class="line">                 ngx_fastdfs_module;</span><br><span class="line">        &#125;</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>启动nginx</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure>

<p>测试上传一张图片</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209103008068.png?msec=1652018063682" alt="image20211209103008068" title>
                </div>
                <div class="image-caption">image20211209103008068</div>
            </figure>

<p>使用nginx 访问上传的图片</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209103101268.png?msec=1652018063877" alt="image20211209103101268" title>
                </div>
                <div class="image-caption">image20211209103101268</div>
            </figure>

<p>安装完成！！！</p>
<p>下面开始添加图片压缩功能</p>
<p>重新进入nginx 源码目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install gd gd-devel ## 安装所需依赖</span><br><span class="line">cd /usr/local/src/fastdfs/nginx-1.10.1</span><br><span class="line">/usr/local/nginx/sbin/nginx -s stop #停止nginx服务</span><br><span class="line">./configure --prefix=/usr/local/nginx --with-http_image_filter_module \</span><br><span class="line">  --add-module=/usr/local/src/fastdfs/fastdfs-nginx-module-1.22/src/</span><br><span class="line">  make</span><br><span class="line">  make install</span><br></pre></td></tr></table></figure>

<p>查看nginx安装的模块</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -V</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209105544164.png?msec=1652018063685" alt="image20211209105544164" title>
                </div>
                <div class="image-caption">image20211209105544164</div>
            </figure>

<p>修改nginx配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> location ~group1/M00/(.+)_(\d+)x(\d+)\.(jpg|gif|png)&#123;</span><br><span class="line">             ngx_fastdfs_module;</span><br><span class="line">             set $w $2;</span><br><span class="line">             set $h $3;</span><br><span class="line">          image_filter resize $w $h;</span><br><span class="line">            image_filter_buffer 10M;</span><br><span class="line">          rewrite group1/M00(.+)_(\d+)x(\d+)\.(jpg|gif|png)$ group1/M00$1.$4 break;</span><br><span class="line">  &#125;</span><br><span class="line"> location ~/group([0-9])/&#123;</span><br><span class="line">        ngx_fastdfs_module;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重新启动nginx</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/20220508/fastDfsConfig/image-20211209105840511.png?msec=1652018063663" alt="image20211209105840511" title>
                </div>
                <div class="image-caption">image20211209105840511</div>
            </figure>

<p>访问上传的图片</p>

            </div>

            <blockquote class="post-copyright">
    
        <div class="content">

            <div>文章作者:
                李子灿
            </div>
            <div>文章链接:
                <a href="https://banatech.org/20220508/fastDfsConfig.html"> https://banatech.org/20220508/fastDfsConfig.html</a>
            </div>
            <div>版权声明: 本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-sa/4.0/legalcode.zh-Hans">CC BY-SA 4.0</a>许可协议。转载请注明来处!
            </div>
            
<span class="post-time">
    最后更新时间：<time datetime="2022-05-08T14:07:32.868Z" itemprop="dateUpdated">2022-05-08 22:07:32</time>
</span><br>


            
        </div>
    
    <footer>
        <a href="https://banatech.org">
            <img src="/img/avatar.jpg" alt="李子灿">
            李子灿
        </a>
    </footer>
</blockquote>

                

    <div class="page-reward">
        <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
    </div>



                    <div class="post-footer">
                        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fastdfs/" rel="tag">fastdfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li></ul>

                            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://banatech.org/20220508/fastDfsConfig.html&title=《fastdfs安装配置及fast-nginx-module整合nginx》 — Li ' s Blog&pic=https://banatech.org/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://banatech.org/20220508/fastDfsConfig.html&title=《fastdfs安装配置及fast-nginx-module整合nginx》 — Li ' s Blog&source=写写字" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://banatech.org/20220508/fastDfsConfig.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《fastdfs安装配置及fast-nginx-module整合nginx》 — Li ' s Blog&url=https://banatech.org/20220508/fastDfsConfig.html&via=https://banatech.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://banatech.org/20220508/fastDfsConfig.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>


                    </div>

        </div>
        
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/20220508/hello-world.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Hello World</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/20220508/hello.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">hello_wod</h4>
      </a>
    </div>
  
</nav>



            




















    <section class="comments" id="comments">
        <!-- 来必力City版安装代码 -->
        <div id="lv-container" data-id="city" data-uid='MTAyMC81NjM0Ni8zMjgwOQ=='>
            <script type="text/javascript">
                (function (d, s) {
                    var j, e = d.getElementsByTagName(s)[0];

                    if (typeof LivereTower === 'function') { return; }
                    j = d.createElement(s);
                    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                    j.async = true;

                    e.parentNode.insertBefore(j, e);
                })(document, 'script');
            </script>
            <noscript> 为正常使用评论功能请激活JavaScript</noscript>
        </div>
        <!-- City版安装代码已完成 -->
    </section>
    



    </article>
    <!-- 打赏图片 -->
    
<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢老板~~~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>


</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>李子灿 &copy; 2021 - 2022</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://banatech.org/20220508/fastDfsConfig.html&title=《fastdfs安装配置及fast-nginx-module整合nginx》 — Li ' s Blog&pic=https://banatech.org/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://banatech.org/20220508/fastDfsConfig.html&title=《fastdfs安装配置及fast-nginx-module整合nginx》 — Li ' s Blog&source=写写字" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://banatech.org/20220508/fastDfsConfig.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《fastdfs安装配置及fast-nginx-module整合nginx》 — Li ' s Blog&url=https://banatech.org/20220508/fastDfsConfig.html&via=https://banatech.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://banatech.org/20220508/fastDfsConfig.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://banatech.org/20220508/fastDfsConfig.html" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦! 你回来啦!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
