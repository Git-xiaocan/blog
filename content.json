{"meta":{"title":"Li ' s Blog","subtitle":"写字的地方","description":"","author":"Li","url":"https://banatech.org","root":"/"},"pages":[{"title":"","date":"2022-05-08T12:01:16.605Z","updated":"2022-05-08T12:01:16.593Z","comments":true,"path":"tags/index.html","permalink":"https://banatech.org/tags/index.html","excerpt":"","text":""},{"title":"","date":"2022-05-08T12:03:04.514Z","updated":"2022-05-08T12:03:04.501Z","comments":true,"path":"categories/index.html","permalink":"https://banatech.org/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"Hello World","slug":"hello-world","date":"2022-05-08T14:53:58.073Z","updated":"2022-05-08T14:53:58.074Z","comments":true,"path":"2022/05/08/hello-world.html","link":"","permalink":"https://banatech.org/2022/05/08/hello-world.html","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[{"name":"技术","slug":"技术","permalink":"https://banatech.org/categories/%E6%8A%80%E6%9C%AF/"},{"name":"Java","slug":"技术/Java","permalink":"https://banatech.org/categories/%E6%8A%80%E6%9C%AF/Java/"}],"tags":[{"name":"C++","slug":"C","permalink":"https://banatech.org/tags/C/"},{"name":"java","slug":"java","permalink":"https://banatech.org/tags/java/"}]},{"title":"fastdfs安装配置及fast-nginx-module整合nginx","slug":"fastDfsConfig","date":"2022-05-08T13:53:19.000Z","updated":"2022-05-08T14:07:32.868Z","comments":true,"path":"2022/05/08/fastDfsConfig.html","link":"","permalink":"https://banatech.org/2022/05/08/fastDfsConfig.html","excerpt":"","text":"由于最近做项目需要用到文件系统，选择了fastdfs+nginx 但是在安装过程中出现了各种报错，在此把踩过的坑都记录一下，下面我介绍的方法，是我亲自验证过的，只要安装的版本和我的一致应该是没问题的。安装过程出现报错大部分都是版本问题，请更换版本安装,尽量选择新版本 1.下载所需的软件以及工具包fastdfs作者的github:https://github.com/happyfish100 所需的所有软件包都可以在这里下载 我安装的对应的版本: fastdfs-6.07 fastdfs-nginx-module-1.22 nginx-1.10.1 下载对应软件包 下面是所需软件的下载地址 fastdfs v6.07 https://github.com/happyfish100/fastdfs/releases/tag/V6.07 image20211209083103614 Fastdfs-nginx-module v1.22 https://github.com/happyfish100/fastdfs-nginx-module/releases/tag/V1.22 image20211209101441171 libfastcommon v1.0.53 https://github.com/happyfish100/libfastcommon/releases/tag/V1.0.53 image20211209083332152 nginx 1.10.1 http://nginx.org/download/nginx-1.10.1.tar.gz image20211209083453661 下面开始安装 在/usr/local/src 目录下信件fastdfs 文件夹 用于存放安装所需的所有软件包源码 123[root@VM-16-12-centos ~]# mkdir /usr/local/src/fastdfs[root@VM-16-12-centos ~]# cd /usr/local/src/fastdfs/[root@VM-16-12-centos fastdfs]# 首先安装基础环境 1yum -y install zlib zlib-devel pcre pcre-devel gcc gcc-c++ openssl openssl-devel libevent libevent-devel perl unzip net-tools wget 下载fastdfs安装所需软件包 下面是所有软件包 请自行前往上面提供的链接下载 image20211209103208043 下面开始安装 首先安装libfastcommon1234tar -zxvf libfastcommon-1.0.53.tar.gz #解压软件包cd libfastcommon-1.0.53/ # 进入目录./make.sh #编译./make.sh install # 安装 验证是否安装成功 image20211209090103427 添加软连接 1234ln -s /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.soln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.soln -s /usr/lib64/libfdfsclient.so /usr/local/lib/libfdfsclient.soln -s /usr/lib64/libfdfsclient.so /usr/lib/libfdfsclient.so 安装fastdfs1234tar -zxvf fastdfs-6.07.tar.gz #解压cd fastdfs-6.07/ #进入解压目录./make.sh #编译./make.sh install #安装 fastdfs 默认安装在 /etc/fdfs 目录下 12345cd /etc/fdfs/ ##进入安装目录#将下列三个配置文件全部cp 一份cp storage.conf.sample storage.confcp tracker.conf.sample tracker.confcp client.conf.sample client.conf 配置tracker服务新建fastdfs 数据的存放目录 下面是我存放的位置 image20211209091431415 修改tracker的配置文件 需要修改下面几个配置项 base_path &#x3D; &#x2F;home&#x2F;yuqing&#x2F;fastdfs 修改为 base_path &#x3D; &#x2F;usr&#x2F;fdfs_data （对应你自己的目录） http.server_port &#x3D; 8080 修改为 http.server_port &#x3D; 8888 (http服务对应的端口) 启动 tracker 服务 image20211209092144873 配置storage1vim /etc/fdfs/storage.conf 修改下面配置项 base_path &#x3D; &#x2F;home&#x2F;yuqing&#x2F; 修改为 base_path &#x3D; &#x2F;usr&#x2F;fdfs_data store_path0 &#x3D; &#x2F;usr&#x2F;fdfs_data&#x2F;storage 修改为 store_path0 &#x3D; &#x2F;usr&#x2F;fdfs_data&#x2F;storage tracker_server &#x3D; 192.168.1.2:22122 修改为 tracker_server &#x3D; 服务器ip:22122 http.server_port &#x3D; 8080 修改为http.server_port &#x3D; 8888 启动storage 服务 image20211209092852821 下面配置 client 服务 测试上传功能 1vim /etc/fdfs/client.conf 修改下面配置项 base_path &#x3D; &#x2F;usr&#x2F;fdfs_data tracker_server &#x3D; 192.168.0.196:22122 修改为 tracker_server &#x3D; 服务器ip:22122 http_tracker_server_port &#x3D;80 修改为http_tracker_server_port &#x3D; 8888 测试上传文件 image20211209093245661 image20211209093522679 将fastdfs源码conf目录下的两个配置文件复制到&#x2F;etc&#x2F;fdfs目录下 12cp /usr/local/src/fastdfs/fastdfs-6.07/conf/http.conf /etc/fdfs/ cp /usr/local/src/fastdfs/fastdfs-6.07/conf/mime.types /etc/fdfs/ 配置Nginx 整合fastdfs-nginx-module访问配置 fastdfs-nginx-module 123456tar -zxvf fastdfs-nginx-module-1.20.tar.gz ##解压tar -zxvf nginx-1.10.1.tar.gzcd ./nginx-1.10.1./configure --prefix=/usr/local/nginx --add-module=/usr/local/src/fastdfs/fastdfs-nginx-module-1.22/srcmakemake install 修改 fastdfs-nginx-module-1.22&#x2F;src&#x2F;mod_fastdfs.conf 配置文件 并复制到 &#x2F;etc&#x2F;fdfs 目录 修改下列几项 base_path&#x3D;&#x2F;usr&#x2F;fdfs_data tracker_server&#x3D;服务器ip:22122 对应tracker服务的ip store_path0&#x3D;&#x2F;usr&#x2F;fdfs_data&#x2F;storage url_have_group_name &#x3D; true 配置nginx 代理1vim /usr/local/nginx/conf/nginx/conf nginx.conf 1234567891011121314server &#123; listen 8888; server_name localhost; location / &#123; root html; index index.html index.htm; &#125; location /group1/M00&#123; ngx_fastdfs_module; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root html; &#125; 启动nginx 1/usr/local/nginx/sbin/nginx 测试上传一张图片 image20211209103008068 使用nginx 访问上传的图片 image20211209103101268 安装完成！！！ 下面开始添加图片压缩功能 重新进入nginx 源码目录 1234567yum install gd gd-devel ## 安装所需依赖cd /usr/local/src/fastdfs/nginx-1.10.1/usr/local/nginx/sbin/nginx -s stop #停止nginx服务./configure --prefix=/usr/local/nginx --with-http_image_filter_module \\ --add-module=/usr/local/src/fastdfs/fastdfs-nginx-module-1.22/src/ make make install 查看nginx安装的模块 1/usr/local/nginx/sbin/nginx -V image20211209105544164 修改nginx配置文件 1234567891011 location ~group1/M00/(.+)_(\\d+)x(\\d+)\\.(jpg|gif|png)&#123; ngx_fastdfs_module; set $w $2; set $h $3; image_filter resize $w $h; image_filter_buffer 10M; rewrite group1/M00(.+)_(\\d+)x(\\d+)\\.(jpg|gif|png)$ group1/M00$1.$4 break; &#125; location ~/group([0-9])/&#123; ngx_fastdfs_module;&#125; 重新启动nginx image20211209105840511 访问上传的图片","categories":[],"tags":[{"name":"fastdfs","slug":"fastdfs","permalink":"https://banatech.org/tags/fastdfs/"},{"name":"nginx","slug":"nginx","permalink":"https://banatech.org/tags/nginx/"}]},{"title":"hello_wod","slug":"hello","date":"2022-05-08T08:56:45.000Z","updated":"2022-05-08T12:09:50.914Z","comments":true,"path":"2022/05/08/hello.html","link":"","permalink":"https://banatech.org/2022/05/08/hello.html","excerpt":"","text":"helosdjojasdiojsadjasdasdasd sadsa d asd 123func mian()&#123; fmt.Println(&quot;我是你爸爸&quot;)&#125;","categories":[],"tags":[{"name":"Go","slug":"Go","permalink":"https://banatech.org/tags/Go/"}]}],"categories":[{"name":"技术","slug":"技术","permalink":"https://banatech.org/categories/%E6%8A%80%E6%9C%AF/"},{"name":"Java","slug":"技术/Java","permalink":"https://banatech.org/categories/%E6%8A%80%E6%9C%AF/Java/"}],"tags":[{"name":"C++","slug":"C","permalink":"https://banatech.org/tags/C/"},{"name":"java","slug":"java","permalink":"https://banatech.org/tags/java/"},{"name":"fastdfs","slug":"fastdfs","permalink":"https://banatech.org/tags/fastdfs/"},{"name":"nginx","slug":"nginx","permalink":"https://banatech.org/tags/nginx/"},{"name":"Go","slug":"Go","permalink":"https://banatech.org/tags/Go/"}]}